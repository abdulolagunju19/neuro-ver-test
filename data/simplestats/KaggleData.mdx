---
title: 'An analysis of a dataset from Kaggle'
publishedAt: '2021-05-19'
summary: 'I provide a tutorial on using python to deal with a dataset from kaggle.'
---

# Tutorials

Let's take a look at a kaggle dataset about medical insurance. This will be a brief introduction on the functions I use in python to analyze data.

So, I like to use spyder to perform my analyses. To download spyder, I just downloaded anaconda. This video explains it pretty well for windows 10 users: 
[Link](https://youtu.be/5mDYijMfSzs) 

### Let's begin!
![Image](/images/begin.gif)

So, the first thing I like to do is download the dataset I would like to look into. For now, I mainly use csv files. To easily use them in my code, I created a repository in my Github account that contains the csv files I downloaded from kaggle. 

To create a repository on github, first you must create an account on github. It should be smooth sailing from there, and I don't think I need to go further into that. Email me if you have any problems.

Now, look through kaggle and download the dataset you like. Unfortunately, Github only takes csv files that are less than 25mb.

Here is the link to the dataset I used: [Medical Insurance Kaggle Dataset](https://www.kaggle.com/mirichoi0218/insurance)

Now that you have spyder and the csv file you need in you repository, click on the csv file on github. Then, click raw. Copy the URL, and we are ready to get to work.
This video explains getting the kaggle url: [Create URL LINK for your DATA from CSV files](https://youtu.be/jDaWna1IRmY)

So, I will briefly explain the methodology I will use when analyzing this code. I will firstly use a python method to describe the variables and their means, standard deviations, etc. Then I will use graphs such as histograms, bar plots and correlation matrices to see what the data reveals. 

Here is the first half of the code of the code.
```python:insurance.py
#import libraries needed
import pandas as pd
import matplotlib.pyplot as plt
import seaborn as sns
import numpy as np
from scipy import stats
import random
#don't want to see warnings on the console, usually about old functions like distplot
import warnings
warnings.filterwarnings('ignore') 

#pass in dataframe (df) csv file from github, check out the raw
df = pd.read_csv("https://raw.githubusercontent.com/abdulolagunju19/csv_files/main/insurance.csv")

#let's quickly look at a summary of the dataset
print(df.info())

#let's see total number of (rows,columns)
print(df.shape) #1338 rows, 7 columns

#take a look at columns
print(df.columns)

#let's take a quick look at a description of the dataset
print(df.describe(include="all")) #looks like  there are no missing values

#take a look at first 5 rows of data
print(df.head()) 
print("\n")

#lets check for duplicate rows
num_dup_rows = len(df) - len(df.drop_duplicates(keep="first"))

if num_dup_rows!= 0:
    print("Number of duplicate rows found : {}\n\nDuplicates removed!".format(num_dup_rows))
    df.drop_duplicates(keep="first",inplace=True)
else:
    print("No duplicate entries found!")

#lets make bar plots for the categorical variables
#for loop looks at sex variable, children variable etc,
#makes a catplot for each
for variable in ['sex', 'children', 'smoker', 'region']:
    #the random.randint is generating colours for our plots, use count plot
    fig = sns.catplot(x=variable,data=df,kind="count",palette="Set"+
                      str(random.randint(1,3)),height=2.5,aspect=2, ci ="sd")
#lets make a pairplot to get some idea of what's going on in the data
plt.figure()
#positive correlation between charges and age? 
#what are these insurance companies doing
sns.pairplot(df) 

plt.figure()
#why are insurance companies dealing mainly with young people?
sns.distplot(df["age"]) 

plt.figure()
sns.distplot(df["bmi"]) #nice normal distribution

plt.figure()
sns.distplot(df["charges"])

#lets take a look at the heatmap
plt.figure()
#so charges and age look to be the most correlated
sns.heatmap(df.corr(), annot=True, linewidths=.5, fmt= '.1f') 

#let's make a scatter plot to 
#take a closer look at the charges and age relationship
plt.figure()
sns.scatterplot(data = df, x = "age", y = "charges", hue = "bmi")
plt.title('Age and Charges Scatter Plot')   

plt.figure()
#are smokers getting charged more
sns.boxplot(x="smoker", y="charges", data = df) 

plt.figure()
#are what region is getting charged the most
sns.boxplot(x="region", y="charges", data = df) 

#take a deeper look at statistics for each age
#groupby shows mean of different variables, separating them by age
print(df.groupby("age").mean())
```
So, with this code you can create histograms, boxplots, scatterplots, clean up your duplicate rows or columns, and describe your dataset pretty adequately.
To learn more about using a module called seaborn to make plots using python, 

Check this out: [Seaborn Tutorial](https://www.kaggle.com/kanncaa1/seaborn-tutorial-for-beginners)

Now, let's see if we can perform some statistical tests on the data.

```python:stats.py
#import libraries needed
import pandas as pd
import numpy as np
#don't want to see warnings on the console, usually about old functions like distplot
import warnings
warnings.filterwarnings('ignore') 

#We have gotten a little intro to the data, lets run some tests
from scipy.stats import ttest_ind

#pass in dataframe (df) csv file from github
df = pd.read_csv("https://raw.githubusercontent.com/abdulolagunju19/csv_files/main/insurance.csv")

def Series_stats(var, category, prop1, prop2):
# Step 1: State the null and alternative hypothesis and select a level of significance is 5% or 0.05
# Step 2: Collect data and calculate the values of test statistic
  s1 = df[(df[category]==prop1)][var]
  s2 = df[(df[category]==prop2)][var]
  t, p = ttest_ind(s1,s2,equal_var = False)

  print("Two-sample t-test: t={}, p={}".format(round(t,5),p))
# Step 3: Compare the probability associated with the test statistic with level of significance specified
  if ((p < 0.05) and (np.abs(t) > 1.96)):
    print("\n REJECT the Null Hypothesis and state that: \n at 5% significance level, the mean {} of {}-{} and {}-{} are not equal.".format(var, prop1, category, prop2, category))
    print("\n YES, the {} of {}-{} differ significantly from {}-{} in the current dataset.".format(var, prop1, category, prop2, category))
    print("\n The mean value of {} for {}-{} is {} and for {}-{} is {}".format(var, prop1, category, round(s1.mean(),2), prop2, category, round(s2.mean(),2)))
  else:
    print("\n FAIL to Reject the Null Hypothesis and state that: \n at 5% significance level, the mean {} of {} - {} and {} - {} are equal.".format(var, prop1, category, prop2, category))
    print("\n NO, the {} of {}-{} NOT differ significantly from {}-{} in the current dataset".format(var, prop1, category, prop2, category))
    print("\n The mean value of {} for {}-{} is {} and for {}-{} is {}".format(var, prop1, category, round(s1.mean(),2), prop2, category, round(s2.mean(),2)))

#Do charges of people who smoke differ significantly from the people who don't?
print(Series_stats('charges','smoker','yes','no'))

#Does BMI of males differ significantly from that of females?
print(Series_stats('bmi','sex','male','female'))
```
You can perform so two-sample t tests with this information.
I learned how to do this from this kaggle code: [Medical insurance analysis](https://www.kaggle.com/winternguyen/usa-health-insurance-cost-key-factors)

Enjoy!

![Westbrook](/images/dancing.gif)
